<!doctype html>
<html lang="zh"><head>
<title>一道vmp逆向题分析 - Em_Lin</title>
<meta charset="UTF-8">
<meta name="keywords" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">

<link rel="shortcut icon" href="https://c.img.dasctf.com/LightPicture/2024/09/0560a6b114c0b93c.png" type="image/png" />
<meta name="description" content="这道题其实不算难，主要是想记录一下vmp的解密流程。在解这道题之前，需要对vmp有一定了解，如果在此之前没有了解过的话，可以参考这篇帖子，这篇帖子基本上讲清楚了vmp的加密过程，甚至有兴趣的话还可以复现该帖子中讲述的vmp加密操作。 一开始拿到这种题我也是一头雾水，用kali远程调试进入初始化界面后，发现一个switch分支选择，如下图：  值得一提的是，我这里远程调试使用的是32位的linux_">
<meta property="og:type" content="article">
<meta property="og:title" content="一道vmp逆向题分析">
<meta property="og:url" content="https://ermu0.cn/2024/10/14/reverse/shell/vmp/01-vmp/index.html">
<meta property="og:site_name" content="Em_Lin">
<meta property="og:description" content="这道题其实不算难，主要是想记录一下vmp的解密流程。在解这道题之前，需要对vmp有一定了解，如果在此之前没有了解过的话，可以参考这篇帖子，这篇帖子基本上讲清楚了vmp的加密过程，甚至有兴趣的话还可以复现该帖子中讲述的vmp加密操作。 一开始拿到这种题我也是一头雾水，用kali远程调试进入初始化界面后，发现一个switch分支选择，如下图：  值得一提的是，我这里远程调试使用的是32位的linux_">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://c.img.dasctf.com/LightPicture/2024/10/fbd846fb89292dc4.png">
<meta property="og:image" content="https://c.img.dasctf.com/LightPicture/2024/10/ea3a394c09ab6b57.png">
<meta property="article:published_time" content="2024-10-13T16:00:00.000Z">
<meta property="article:modified_time" content="2024-10-13T16:00:00.000Z">
<meta property="article:author" content="Em_Lin">
<meta property="article:tag" content="shell">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://c.img.dasctf.com/LightPicture/2024/10/fbd846fb89292dc4.png">

<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


<link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1728905417397">

<link rel="stylesheet" href="/css/style.css?v=1728905417397">




    
        <link rel="stylesheet" href="/custom.css?v=1728905417397">
    



<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>
<script src="/lib/lax.min.js" async></script>


<script async src="/js/app.js?v=1728905417397"></script>

 

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">


<link rel="stylesheet"  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
<meta name="generator" content="Hexo 5.4.0"></head><body class="nexmoe mdui-drawer-body-left"><div id="nexmoe-background"><div class="nexmoe-bg" style="background-image: url(https://c.img.dasctf.com/LightPicture/2024/09/24b88941b6afcc33.png)"></div><div class="mdui-appbar mdui-shadow-0"><div class="mdui-toolbar"><a class="mdui-btn mdui-btn-icon mdui-ripple" mdui-drawer="{target: &#039;#drawer&#039;, swipe: true}" title="menu"><i class="mdui-icon nexmoefont icon-menu"></i></a><div class="mdui-toolbar-spacer"></div><a class="mdui-btn mdui-btn-icon" href="/" title="Em_Lin"><img src="https://c.img.dasctf.com/LightPicture/2024/09/0560a6b114c0b93c.png" alt="Em_Lin"></a></div></div></div><div id="nexmoe-header"><div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Em_Lin">
            <img src="https://c.img.dasctf.com/LightPicture/2024/09/0560a6b114c0b93c.png" alt="Em_Lin" alt="Em_Lin">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>12</div>
        <div><span>标签</span>4</div>
        <div><span>分类</span>3</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" target="_blank" rel="noopener" href="https://ermu0.github.io/2024/09/10/hello-world/" title="关于博主">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博主
            </div>
        </a>
        
    </div>
    
    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="搜索"></label>
            </form>
         
    </div>
</div>




    
        
        <div class="nexmoe-widget-wrap">
	<div class="nexmoe-widget nexmoe-social">
		<a
			class="mdui-ripple"
			href="https://nexmoe.com/3145B9F.html"
			target="_blank"
			mdui-tooltip="{content: 'QQ'}"
			style="
				color: rgb(249, 174, 8);
				background-color: rgba(249, 174, 8, .1);
			"
		>
			<i
				class="nexmoefont icon-QQ"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://space.bilibili.com/628727362"
			target="_blank"
			mdui-tooltip="{content: '哔哩哔哩'}"
			style="
				color: rgb(231, 106, 141);
				background-color: rgba(231, 106, 141, .1);
			"
		>
			<i
				class="nexmoefont icon-bilibili"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://github.com/ermu0/"
			target="_blank"
			mdui-tooltip="{content: 'GitHub'}"
			style="
				color: rgb(25, 23, 23);
				background-color: rgba(25, 23, 23, .1);
			"
		>
			<i
				class="nexmoefont icon-github"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://nexmoe.com/atom.xml"
			target="_blank"
			mdui-tooltip="{content: 'RSS'}"
			style="
				color: rgb(247, 132, 34);
				background-color: rgba(247, 132, 34, .1);
			"
		>
			<i
				class="nexmoefont icon-rss"
			></i> </a
		>
	</div>
</div>

    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Android/">Android</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/加密算法/">加密算法</a>
          <span class="category-list-count">6</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/逆向/">逆向</a>
          <span class="category-list-count">4</span>
        </li>

        
      </ul>

    </div>
  </div>


    
        
        
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/DEX/" style="font-size: 10px;">DEX</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/tasks/" style="font-size: 20px;">tasks</a> <a href="/tags/%E7%AE%80%E4%BB%8B/" style="font-size: 10px;">简介</a>
    </div>
    
      <script>
        var maxTagcloud = parseInt(17);
        var tags_length = parseInt(4);
        var tags_arr = [];
        for(var i = 0; i < tags_length; i++){
          tags_arr.push(i);
        }
        tags_arr.sort(function (l, r) {
          return Math.random() > 0.5 ? -1 : 1;
        });
        tags_arr = tags_arr.slice(0, maxTagcloud < tags_length ? tags_length - maxTagcloud : 0);
        for(var tag_i = 0; tag_i < tags_arr.length; tag_i++){
          document.getElementById("randomtagcloud").children[tags_arr[tag_i]].style.display = 'none';
        }
      </script>
    
  </div>

    
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/">2024</a><span class="archive-list-count">12</span></li></ul>
    </div>
  </div>



    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">最新文章</h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2024/10/14/reverse/shell/vmp/01-vmp/">一道vmp逆向题分析</a>
          </li>
        
          <li>
            <a href="/2024/09/26/Android/01.DEX/">DEX文件格式（一）</a>
          </li>
        
          <li>
            <a href="/2024/09/18/algorithm/tea/">TEA</a>
          </li>
        
          <li>
            <a href="/2024/09/18/algorithm/aes/">AES</a>
          </li>
        
          <li>
            <a href="/2024/09/18/algorithm/des/">DES</a>
          </li>
        
      </ul>
    </div>
  </div>

    
        
   
    <div class="nexmoe-copyright">
        &copy; 2024 Em_Lin
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        <br><a target="_blank" href="https://beian.miit.gov.cn/">鄂ICP备2020018486号</a>

<!--这里可以自行更改    
<br><a target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral">
<img src="https://i.dawnlab.me/c0268c1e6cfd0863d6ba35be1575941a.png" width="150px"></a>
-->    

    </div>
</div><!-- .nexmoe-drawer --></div><div id="nexmoe-content"><div class="nexmoe-primary"><div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover"> 
            <img src="https://c.img.dasctf.com/LightPicture/2024/09/24b88941b6afcc33.png" alt="一道vmp逆向题分析" loading="lazy">
            <h1>一道vmp逆向题分析</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2024年10月14日</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/%E9%80%86%E5%90%91/">逆向</a>
        
        
    </div>
    
    
    
    
    
</div>

    <p>这道题其实不算难，主要是想记录一下vmp的解密流程。在解这道题之前，需要对vmp有一定了解，如果在此之前没有了解过的话，可以参考这篇<a target="_blank" rel="noopener" href="https://mrwq.github.io/aggregate-paper/butian/%E9%82%A3CTF%EF%BC%8C%E9%82%A3VMre%EF%BC%8C%E9%82%A3%E4%BA%9B%E4%BA%8B%EF%BC%88%E4%B8%80%EF%BC%89/">帖子</a>，这篇帖子基本上讲清楚了vmp的加密过程，甚至有兴趣的话还可以复现该帖子中讲述的vmp加密操作。</p>
<p>一开始拿到这种题我也是一头雾水，用kali远程调试进入初始化界面后，发现一个switch分支选择，如下图：</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://c.img.dasctf.com/LightPicture/2024/10/fbd846fb89292dc4.png" alt="主程序界面" data-caption="主程序界面" loading="lazy"></p>
<p>值得一提的是，我这里远程调试使用的是32位的<code>linux_server</code>文件，而这也为后续flag的非预期埋下了伏笔。进入界面后，发现switch分支选择一共有15个，分别代表了15个不同的操作，除了第15个操作不是函数以外，其它全是函数操作并都有参数进入，然后我理了一下这15个操作的逻辑，发现：</p>
<ul>
<li>发现对值的操作有2、4、7（+、*、^四种操作）</li>
<li>而存入和取值的操作有1、8、9、10、11、15<br>（其中1、8、9、11、15是取值，10是存值）</li>
<li>关于地址的操作有11、13、14</li>
<li>关于值的比较有12</li>
<li>程序的开始是3</li>
<li>5、6是正确与错误的判断退出</li>
</ul>
<p>到这里知晓了各个函数的作用，接下来就是根据参考帖子给出的思路，提取<strong>操作指令码</strong>。到这里我也明白了，vmp的题，你起码得知道程序整体运行逻辑，才有后面的逆向吧。提取后的操作指令如下图：</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://c.img.dasctf.com/LightPicture/2024/10/ea3a394c09ab6b57.png" alt="程序操作码" data-caption="程序操作码" loading="lazy"></p>
<p>上面的脚本可以直接<code>shift+F2</code>弹出python脚本窗口后使用，脚本的目的是为了打印从基址开始的所有操作指令信息（该基址也就是3指令所在地址，而3指令指向的函数就是我们最开始的输入）。最后，提取到的指令码信息如下：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, </span><br><span class="line"><span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, </span><br><span class="line"><span class="number">13</span>, </span><br><span class="line"> [<span class="number">7</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">12</span>, </span><br><span class="line">  <span class="number">14</span>, <span class="number">5</span>], </span><br><span class="line"> <span class="number">10</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">15</span>, </span><br><span class="line"> <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>, </span><br><span class="line"><span class="number">14</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">11</span>, </span><br><span class="line"> <span class="number">6</span>]</span><br></pre></td></tr></table></figure>

<p>我这里稍微整理了指令的逻辑，发现15和10这里的操作不用管，全部都是存取值操作；13以及14貌似是跳转，而中间重复出现的操作码貌似就是加密流程。但是提取到操作码之后我仍然不知道具体的逻辑，前后指令的衔接有什么关联，并且在实际动调中发现操作码运行到13后突然就飞到了10的位置，我还以为13后面跟着的7及其后面的操作码是没有用的（上面用<code>[]</code>框起来的指令信息），结果并不是，而是在暂时没有用到而已。后面我利用ida动调重新整理了一下逻辑，实际运行的操作码顺序如下：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3</span>, </span><br><span class="line"><span class="number">1</span>, <span class="number">1</span>, </span><br><span class="line"><span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">10</span>, </span><br><span class="line"><span class="number">13</span>, </span><br><span class="line"> [<span class="number">7</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">12</span>, </span><br><span class="line">  <span class="number">14</span>, <span class="number">5</span>](?), </span><br><span class="line"><span class="number">10</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">15</span>, </span><br><span class="line"> <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>, </span><br><span class="line"><span class="number">14</span>,</span><br><span class="line"> <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>, </span><br><span class="line"><span class="number">14</span>,</span><br><span class="line"> <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>,</span><br><span class="line"><span class="number">14</span>,</span><br><span class="line"> <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>,</span><br><span class="line"><span class="number">14</span>,</span><br><span class="line"> <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>,</span><br><span class="line"><span class="number">14</span>,</span><br><span class="line"> <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>,</span><br><span class="line"><span class="number">14</span>,</span><br><span class="line"> <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>,</span><br><span class="line"><span class="number">14</span>,</span><br><span class="line"> <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>,</span><br><span class="line"><span class="number">14</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">11</span>, </span><br><span class="line"> [<span class="number">7</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">12</span>](!), </span><br><span class="line"><span class="number">14</span>, </span><br><span class="line"> <span class="number">6</span>]</span><br></pre></td></tr></table></figure>

<p>可以看到加密一共执行了8轮，每一轮会重复进行8次加密操作，然后采用操作码12比较。到这里我一开始还认为12这里的比较是将输入的加密结果与正确的加密结果进行比较，但是后来发现并不是，12比较的是整个加密的循环次数。而我框起来的部分才是真正的加密判断。</p>
<p>我之所以能够清楚12是做循环判断，而框起来的部分是做加密判断，还是因为那篇帖子启示了我，后面我重新理了一遍逻辑。我发现，我没有将操作码后面跟着的两个参数值(<strong>参数1</strong>：<u>基址+4</u>、<strong>参数2</strong>：<u>基址+8</u>、<strong>操作码</strong>：<u>基址+12</u>)给跑下来，所以就导致我只能了解程序大概的流程，但是对于加密的细节等我还是未知，因此后面我又将操作码及其后面跟着的两个参数用脚本跑下来了，下面给出详细的操作码信息（我在后面作了详细解释）：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3</span>, <span class="number">6</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">887631448</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="comment"># 这里面出现的前64个数据就是给定的要进行加密操作的数据</span></span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">853697698</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="comment"># 而最后8个数据则是通过我们的输入加密得到的结果</span></span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">461124623</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="comment"># 程序要比对的正确加密数据则是第64个数据后的8个数据</span></span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">245186321</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">646846967</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1154116891</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">301809988</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">861868077</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">127091298</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">262294727</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">215708545</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1654203685</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">53950545</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">700606238</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1848475402</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1879388492</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1946291888</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1927762797</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1284115093</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">671092233</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">306073375</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">917468502</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">697240523</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">973896536</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">846872178</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1595827532</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">945648588</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">860827719</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">336163122</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">924592411</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">873999272</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">152124282</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1065431066</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1022704734</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1181311206</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">859976615</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1966877851</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">81291526</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">2113741312</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1458649115</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">735708505</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">727216090</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1426344677</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">14041395</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">515709611</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1475150066</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1202930039</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1875460324</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1821127455</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1333003323</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">2059534858</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1867060019</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1169256435</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">380318198</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1911454699</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1106722493</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">718999965</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">615938873</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1450720726</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">471336241</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">997985349</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">631128684</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1302688383</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">773211089</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">1191123507</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">3998692370</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">2768718402</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">3824930148</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">2389687701</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">4087898125</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">3811936080</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">0</span>, <span class="number">3319820756</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">3</span>, <span class="number">450</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">13</span>, <span class="number">489</span>, <span class="number">0</span>, <span class="comment"># 跳转到操作码为10的前12字节的位置，489是偏移</span></span><br><span class="line"> </span><br><span class="line"> [<span class="number">7</span>, <span class="number">2</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">9</span>, <span class="number">4</span>, </span><br><span class="line"> <span class="number">15</span>, <span class="number">10</span>, <span class="number">32</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">11</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">5</span>, <span class="number">2</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">12</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">12</span>, <span class="number">11</span>, <span class="number">12</span>, </span><br><span class="line"> <span class="number">14</span>, <span class="number">684</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">2</span>, <span class="number">9</span>, </span><br><span class="line"> <span class="number">12</span>, <span class="number">2</span>, <span class="number">10</span>, </span><br><span class="line"> <span class="number">14</span>, <span class="number">459</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, ]</span><br><span class="line"> </span><br><span class="line"> <span class="number">10</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="comment"># 索引7位置还是0，也就是等效于10 0 0</span></span><br><span class="line"> <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>,  <span class="comment"># 把input此时的偏移量分别覆盖了7和3索引</span></span><br><span class="line"> <span class="number">7</span>, <span class="number">2</span>, <span class="number">2</span>,  <span class="comment"># 通过异或操作对索引2赋值0</span></span><br><span class="line"> <span class="number">15</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="comment"># 它把4存入了索引12的位置（这个感觉像是个自增常量值4，类似于+=4）</span></span><br><span class="line"> <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="comment"># 同理，它把8存入了索引13的位置</span></span><br><span class="line"> <span class="number">15</span>, <span class="number">14</span>, <span class="number">64</span>, <span class="comment"># 把64存入了索引14的位置</span></span><br><span class="line"> </span><br><span class="line"> <span class="number">7</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="comment"># 通过异或对索引10位置赋值0（但是每一轮相加的结果已经保存到了大数组input的后面，数字很明显，第二个0后开始的字节数组）</span></span><br><span class="line"> <span class="number">8</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="comment"># 取出input数组的第一位，即我们的输入的第一个4字节数据30303030，然后把值存入索引0的位置，即取出我们的第一个4字节输入然后存放到tmp（第二轮的循环开始会重新开始）</span></span><br><span class="line"> <span class="number">1</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment"># 然后把取出的值30303030存放到了索引9的位置</span></span><br><span class="line"> </span><br><span class="line"> <span class="number">1</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="comment"># 接着把索引2的值存放到了索引11的位置（第二轮索引2为8）</span></span><br><span class="line"> <span class="number">4</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="comment"># 把索引11和12位置的数相乘最后存放到11，此时索引11是0，索引12是4，结果还是0（第二轮这里索引11值为32，因为索引12没变）</span></span><br><span class="line"> </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="comment"># 取出索引11的值0以及索引4的值0x24计算地址（索引4也是没变，是个常量），最后取出input数组的第一位加密值34e82e58存放到索引0的位置，即取出第一位加密值然后存放到tmp</span></span><br><span class="line"> <span class="number">4</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment"># 把索引0和9位置的数相乘最后存放到9，此时索引0是加密值34e82e58，索引9的值是输入值30303030，相乘后最后存放到索引9，结果是a4b93080</span></span><br><span class="line"> <span class="number">2</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="comment"># 把索引10和9位置的数相加最后存放到索引10，此时索引9是a4b93080，索引10是0，最后存放到索引10，结果是a4b93080（感觉10代表的是sum）</span></span><br><span class="line"> </span><br><span class="line"> <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="comment"># 在0x24的基础加上4也就是0x28来作为input数组索引取值，然后把值存入索引为0的位置，即取出我们输入的第2个4字节组30303030存放到tmp</span></span><br><span class="line"> <span class="number">1</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment"># 然后把取出的值30303030存放到了索引9的位置，覆盖掉上一次相乘结果</span></span><br><span class="line"> <span class="number">2</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="comment"># 将索引11和12位置的数相加最后存放到索引11，此时索引11是0，索引12是4，结果变成了4，然后把结果存入11，即索引11的值从0变成了4（感觉像是在计算偏移，即进行i++操作）</span></span><br><span class="line"> </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="comment"># 取出索引11的值4以及索引4的值0x24计算地址，最后取出input数组的第二位加密值32e264a2存放到索引0的位置，即取出第二位加密值存放到tmp</span></span><br><span class="line"> <span class="number">4</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment"># 把索引0和9位置的数相乘最后存放到9，此时索引0是加密值32e264a2，索引9是输入值30303030（已经是第2组了），相乘后存入索引9，结果是3bb13e60</span></span><br><span class="line"> <span class="number">2</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="comment"># 把索引9和10位置上的数相加后存入到索引10的位置，此时索引10是a4b93080，索引9位置是3bb13e60，结果是e06a6ee0</span></span><br><span class="line"> <span class="number">8</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="comment"># 在0x24的基础上加上8也就是0x2c来作为input数组索引取值，然后把值存入索引为0的位置，即取出输入的第3个4字节数组31313131存放到tmp</span></span><br><span class="line"> <span class="number">1</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment"># 把取出的值31313131存放到索引为9的位置，覆盖掉上一次相乘结果</span></span><br><span class="line"> <span class="number">2</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="comment"># *11和*12相加，结果存放到*11，*11=4，*12=4，结果*11=8，*12=4</span></span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="comment"># 后面的计算过程与上面一致，唯一的问题是除了这样的小循环，还有大循环等着</span></span><br><span class="line"> <span class="number">4</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">10</span>, <span class="number">9</span>, </span><br><span class="line"> <span class="number">8</span>, <span class="number">1</span>, <span class="number">12</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">11</span>, <span class="number">12</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">11</span>, </span><br><span class="line"> <span class="number">4</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">10</span>, <span class="number">9</span>, </span><br><span class="line"> <span class="number">8</span>, <span class="number">1</span>, <span class="number">16</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">11</span>, <span class="number">12</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">11</span>, </span><br><span class="line"> <span class="number">4</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">10</span>, <span class="number">9</span>, </span><br><span class="line"> <span class="number">8</span>, <span class="number">1</span>, <span class="number">20</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">11</span>, <span class="number">12</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">11</span>, </span><br><span class="line"> <span class="number">4</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">10</span>, <span class="number">9</span>, </span><br><span class="line"> <span class="number">8</span>, <span class="number">1</span>, <span class="number">24</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">11</span>, <span class="number">12</span>, </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">11</span>, </span><br><span class="line"> <span class="number">4</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">10</span>, <span class="number">9</span>, </span><br><span class="line"> <span class="number">8</span>, <span class="number">1</span>, <span class="number">28</span>, </span><br><span class="line"> <span class="number">1</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">11</span>, <span class="number">12</span>, </span><br><span class="line"> </span><br><span class="line"> <span class="number">9</span>, <span class="number">4</span>, <span class="number">11</span>, </span><br><span class="line"> <span class="number">4</span>, <span class="number">9</span>, <span class="number">0</span>, </span><br><span class="line"> <span class="number">2</span>, <span class="number">10</span>, <span class="number">9</span>, </span><br><span class="line"> <span class="number">10</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="comment"># 将索引10处的值10c33a07存入input数组中，此时input的偏移为0x14c，存入后偏移会+4，及变成了0x150</span></span><br><span class="line"> <span class="number">2</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="comment"># 将索引2处的值与索引13处的值进行相加，最后存入索引2处，此时索引2值为0，索引13值为8，相加结果为8，最后索引2处值会变成8</span></span><br><span class="line"> <span class="number">12</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="comment"># 将索引2以及14位置的值进行比较，此时索引2值为8，索引14值为64，此时值大小显然不一致（12其实是循环退出条件？）</span></span><br><span class="line"> </span><br><span class="line"> <span class="number">14</span>, <span class="number">510</span>, <span class="number">0</span>,  <span class="comment"># 将510与操作码基址相加，重新定位下一条指令地址，即进行条件判断后跳转，判断条件就是上面一个12判断结果是否为1，而12的判断结果则是计算循环次数是否达标。所以最后14判断不成立后会重新定位到操作码7的位置。</span></span><br><span class="line"> </span><br><span class="line"> <span class="number">1</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="comment"># 加密循环结束后，将索引7处的值赋值到索引6处，此时索引7处值为偏移值332(0x14c)，而原先的索引6值为364(0x16c)，那么被赋值后索引6处值为0x14c</span></span><br><span class="line"> <span class="number">11</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="comment"># 然后利用全局偏移对input数组寻址，最后将寻到的值赋值给索引7处的位置，值为10c33a07，然后将偏移-=4，即向前移动，此时全局偏移为0x148，然后再判断此时索引值是否为8（此时索引为7），若不为8则正常运行</span></span><br><span class="line"> <span class="number">11</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="comment"># 再次利用全局偏移对input寻址，此时索引还是7，最后找到的值为0存入索引7，然后再次将偏移-=4，向前移动，此时全局偏移为0x144，由于此时索引仍不为8，所以程序正常运行</span></span><br><span class="line"> <span class="number">11</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="comment"># 再次利用全局偏移对input寻址，此时索引为8，然后将找到的值为1c2存入索引8，接着再将偏移-=4，向前移动，此时全局偏移为0x140，由于此时索引==8，所以程序会执行一个跳转，将操作基址与4*1c2相加，进行重定位，这个新地址指向新的操作码，也就是7，这个7与上面加密循环的7不一样，它执行的是下面的命令</span></span><br><span class="line"> </span><br><span class="line"> [<span class="number">7</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="comment"># 将此时索引2处的值0x40(循环判断)通过异或计算重新清0，操作后索引2处的值为0</span></span><br><span class="line"> <span class="number">15</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="comment"># 将4赋值给索引9处</span></span><br><span class="line"> <span class="number">15</span>, <span class="number">10</span>, <span class="number">32</span>, <span class="comment"># 将32赋值给索引10处，最后一轮的sum：cc55e5f9被覆盖</span></span><br><span class="line"> <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="comment"># 取索引3处(0x14c)与2处(0)的值进行地址计算，最后将值10c33a07赋值到索引0处</span></span><br><span class="line"> <span class="number">1</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="comment"># 将10c33a07赋值到索引11处，原先的11处值为fc，此时索引11处的值为10c33a07</span></span><br><span class="line"> <span class="number">9</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="comment"># 取索引5处(0x124)与2处(0)的值进行地址计算，最后将值46ff1a33赋值到索引0处</span></span><br><span class="line"> <span class="number">1</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="comment"># 然后将值赋值到索引12处，原先的索引12处值为4，此时索引12处的值为46ff1a33</span></span><br><span class="line"> <span class="number">12</span>, <span class="number">11</span>, <span class="number">12</span>,] <span class="comment"># 最后将索引11处的值与索引12处的值进行比较，结果正确返回1，错误返回0</span></span><br><span class="line"> </span><br><span class="line"> <span class="number">14</span>, <span class="number">684</span>, <span class="number">0</span> <span class="comment"># 由于判断错误会执行重定位，基址加上传进来的参数684(0x2ac)，新地址指向的操作码为6，所以直接判断错误退出。(我猜测这里只要有一处判断没有通过就会退出，而不会执行后续判断)</span></span><br><span class="line"> </span><br><span class="line"> <span class="number">6</span>]</span><br></pre></td></tr></table></figure>

<p>跟着动调一遍，基本就理清了整个程序的运行逻辑，其中的加密逻辑非常简单，只用到了加乘操作。</p>
<p>整个程序会将用户的32字节输入变成8组4字节数据，然后用这8组字节数据与给定的64个4字节常量，按照8个一组一一对应的形式相乘再相加，这样一轮加密就结束了，最后将相加结果存入一个数组中，重复上述操作8次，最后数组会存入8个结果，最后会将数组值取出，与给定的正确加密结果比对，如果第一个值的比对没有成功，程序就会判断错误退出。</p>
<p>这就是整个程序的逻辑，下面给出我<strong>模拟</strong>的程序<strong>正向运行</strong>代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 模拟程序正向运行过程</span></span><br><span class="line">	<span class="keyword">int</span> test[] = &#123;<span class="number">0x30303030</span>, <span class="number">0x30303030</span>, <span class="number">0x31313131</span>, <span class="number">0x31313131</span>, <span class="number">0x32323232</span>, <span class="number">0x32323232</span>, <span class="number">0x33333333</span>, <span class="number">0x33333333</span>&#125;;	</span><br><span class="line">	<span class="keyword">int</span> code[] = &#123;</span><br><span class="line">		<span class="number">0x34E82E58</span>, <span class="number">0x32E264A2</span>, <span class="number">0x1B7C340F</span>, <span class="number">0x0E9D3F11</span>, <span class="number">0x268E19F7</span>, <span class="number">0x44CA6D1B</span>, <span class="number">0x11FD4144</span>, <span class="number">0x335F102D</span>,</span><br><span class="line">		<span class="number">0x7934262</span>, <span class="number">0x0FA24CC7</span>, <span class="number">0x0CDB7381</span>, <span class="number">0x62992525</span>, <span class="number">0x3373851</span>, <span class="number">0x29C2671E</span>, <span class="number">0x6E2D7F0A</span>, <span class="number">0x7005314C</span>,</span><br><span class="line">		<span class="number">0x74020EB0</span>, <span class="number">0x72E7536D</span>, <span class="number">0x4C8A0A95</span>, <span class="number">0x28000E09</span>, <span class="number">0x123E4F1F</span>, <span class="number">0x36AF7556</span>, <span class="number">0x298F0BCB</span>, <span class="number">0x3A0C7B58</span>,</span><br><span class="line">		<span class="number">0x327A3E72</span>, <span class="number">0x5F1E654C</span>, <span class="number">0x385D73CC</span>, <span class="number">0x334F3047</span>, <span class="number">0x14097132</span>, <span class="number">0x371C291B</span>, <span class="number">0x34182BA8</span>, <span class="number">0x9113B7A</span>,</span><br><span class="line">		<span class="number">0x3F81301A</span>, <span class="number">0x3CF53C5E</span>, <span class="number">0x466960E6</span>, <span class="number">0x334233A7</span>, <span class="number">0x753C2C9B</span>, <span class="number">0x4D86906</span>, <span class="number">0x7DFD2200</span>, <span class="number">0x56F1381B</span>,</span><br><span class="line">		<span class="number">0x2BDA0559</span>, <span class="number">0x2B586FDA</span>, <span class="number">0x55044AE5</span>, <span class="number">0x0D64133</span>, <span class="number">0x1EBD1AAB</span>, <span class="number">0x57ED00F2</span>, <span class="number">0x47B34177</span>, <span class="number">0x6FC940E4</span>,</span><br><span class="line">		<span class="number">0x6C8C331F</span>, <span class="number">0x4F74043B</span>, <span class="number">0x7AC2020A</span>, <span class="number">0x6F491333</span>, <span class="number">0x45B16FF3</span>, <span class="number">0x16AB31F6</span>, <span class="number">0x71EE7BEB</span>, <span class="number">0x41F73EBD</span>,</span><br><span class="line">		<span class="number">0x2ADB119D</span>, <span class="number">0x24B67B39</span>, <span class="number">0x56783DD6</span>, <span class="number">0x1C180531</span>, <span class="number">0x3B7C0C45</span>, <span class="number">0x259E426C</span>, <span class="number">0x4DA5727F</span>, <span class="number">0x2E1643D1</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> test_encode[<span class="number">10</span>]; </span><br><span class="line">	<span class="keyword">int</span> i, j;</span><br><span class="line">	<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++) &#123;</span><br><span class="line">		sum = <span class="number">0</span>; </span><br><span class="line">		<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123; <span class="comment">// 小循环每次从头开始 </span></span><br><span class="line">			sum += test[i] * code[c];</span><br><span class="line">			c++;</span><br><span class="line">		&#125;</span><br><span class="line">		test_encode[j] = sum;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">8</span>; k++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, test_encode[k]);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我这里采用的输入是：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00000000111111112222222233333333</span></span><br></pre></td></tr></table></figure>

<p>最后加密结果应该是：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x10c33a07</span>, <span class="number">0x8cd09a46</span>, <span class="number">0x3584e781</span>, <span class="number">0xe41edd13</span>,</span><br><span class="line"><span class="number">0xb2cf4250</span>, <span class="number">0xef6c19f3</span>, <span class="number">0xb9ccc787</span>, <span class="number">0xcc55e5f9</span></span><br></pre></td></tr></table></figure>

<p>根据正向脚本（不难看出正向加密过程其实就是线性方程组），逆向脚本也会很容易得出（我这里偷了懒，让GPT帮我用z3库写了脚本——z3库对解线性方程组有奇效），脚本如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line"># 定义8个整数变量，代表 test 数组的8个元素</span><br><span class="line">test = [BitVec(f&#x27;test_&#123;i&#125;&#x27;, 32) for i in range(8)]</span><br><span class="line"># 给定的 test_encode 数组</span><br><span class="line">test_encode = [</span><br><span class="line">    0x46FF1A33, 0xEE573412, 0xA5074A42, 0xE3FBCD64,</span><br><span class="line">    0x8E6FBD95, 0xF3A8600D, 0xE3358750, 0xC5E071D4</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 0x10c33a07, 0x8cd09a46, 0x3584e781, 0xe41edd13,</span><br><span class="line"># 0xb2cf4250, 0xef6c19f3, 0xb9ccc787, 0xcc55e5f9</span><br><span class="line"></span><br><span class="line"># 给定的 code 数组</span><br><span class="line">code = [</span><br><span class="line">    0x34E82E58, 0x32E264A2, 0x1B7C340F, 0x0E9D3F11, 0x268E19F7, 0x44CA6D1B, 0x11FD4144, 0x335F102D,</span><br><span class="line">    0x7934262, 0x0FA24CC7, 0x0CDB7381, 0x62992525, 0x3373851, 0x29C2671E, 0x6E2D7F0A, 0x7005314C,</span><br><span class="line">    0x74020EB0, 0x72E7536D, 0x4C8A0A95, 0x28000E09, 0x123E4F1F, 0x36AF7556, 0x298F0BCB, 0x3A0C7B58,</span><br><span class="line">    0x327A3E72, 0x5F1E654C, 0x385D73CC, 0x334F3047, 0x14097132, 0x371C291B, 0x34182BA8, 0x9113B7A,</span><br><span class="line">    0x3F81301A, 0x3CF53C5E, 0x466960E6, 0x334233A7, 0x753C2C9B, 0x4D86906, 0x7DFD2200, 0x56F1381B,</span><br><span class="line">    0x2BDA0559, 0x2B586FDA, 0x55044AE5, 0x0D64133, 0x1EBD1AAB, 0x57ED00F2, 0x47B34177, 0x6FC940E4,</span><br><span class="line">    0x6C8C331F, 0x4F74043B, 0x7AC2020A, 0x6F491333, 0x45B16FF3, 0x16AB31F6, 0x71EE7BEB, 0x41F73EBD,</span><br><span class="line">    0x2ADB119D, 0x24B67B39, 0x56783DD6, 0x1C180531, 0x3B7C0C45, 0x259E426C, 0x4DA5727F, 0x2E1643D1</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 将 code 数组转化为 8x8 的矩阵</span><br><span class="line">A = [code[i*8:(i+1)*8] for i in range(8)]</span><br><span class="line"></span><br><span class="line"># 初始化 Z3 求解器</span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"># 添加约束条件：矩阵乘法 A * test = test_encode</span><br><span class="line">for i in range(8):</span><br><span class="line">    equation = Sum([A[i][j] * test[j] for j in range(8)]) == test_encode[i]</span><br><span class="line">    solver.add(equation)</span><br><span class="line"></span><br><span class="line"># 尝试求解</span><br><span class="line">if solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    result = [model[test[i]].as_long() for i in range(8)]</span><br><span class="line">    print(&quot;找到符合条件的 test 数组:&quot;, [hex(x) for x in result])</span><br><span class="line">else:</span><br><span class="line">    print(&quot;未找到解。&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行得到的结果是：（这里是小端序输出的结果，因为ida会将输入以小端序存储然后再进行计算）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0xe7616c66</span> <span class="number">0x6e69317b</span> <span class="number">0x9f724033</span> <span class="number">0xf4757145</span> </span><br><span class="line"><span class="number">0xee4f6937</span> <span class="number">0x1269765f</span> <span class="number">0x31417574</span> <span class="number">0x3d457a49</span></span><br></pre></td></tr></table></figure>

<p>最后将上面倒序一下就是正确的flag：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x666C61E7</span> <span class="number">0x7B31696E</span> <span class="number">0x3340729F</span> <span class="number">0x457175F4</span> </span><br><span class="line"><span class="number">0x37694FEE</span> <span class="number">0x5F766912</span> <span class="number">0x74754131</span> <span class="number">0x497A453D</span></span><br></pre></td></tr></table></figure>

<p>得到的flag应该是：**<code>fla\xe7&#123;1in3@r\x9fEqu\xf47iO\xee_vi\x12tuA1IzE=</code>**</p>
<p>聪明如你，肯定也发现了flag出现了不可显字符，我最开始解出flag也认为是我解错了，后来又把十六进制数据拿去动调修改验证，发现答案其实是正确的。初步猜测是因为运算是在int 32位上的，导致运算溢出然后求出非预期解了。（ok伏笔回收）</p>
<p>总结一下，整个vmp的解密流程：</p>
<ol>
<li>找到程序的操作码；</li>
<li>理清操作码并重新整理操作码顺序；</li>
<li>找到操作码后面跟着的指令信息（一般是操作码、指令1、指令2，三位一组的形式），并通过动调等手段整理逻辑；</li>
<li>最后就是将整理的逻辑尝试还原。</li>
</ol>
<p>一句话，理清操作码前后逻辑来以此还原源程序。</p>

    
  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>本文作者：</strong>Em_Lin<br>
        <strong>本文链接：</strong><a href="https://ermu0.cn/2024/10/14/reverse/shell/vmp/01-vmp/" title="https:&#x2F;&#x2F;ermu0.cn&#x2F;2024&#x2F;10&#x2F;14&#x2F;reverse&#x2F;shell&#x2F;vmp&#x2F;01-vmp&#x2F;" target="_blank" rel="noopener">https:&#x2F;&#x2F;ermu0.cn&#x2F;2024&#x2F;10&#x2F;14&#x2F;reverse&#x2F;shell&#x2F;vmp&#x2F;01-vmp&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0 CN</a> 协议进行许可

        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/shell/" rel="tag">shell</a>
    
</div>
  
  

  
      <div class="nexmoe-post-footer">
          <script src="https://giscus.app/client.js"
    data-repo="nexmoe/nexmoe.com"
    data-repo-id="R_kgDOJI1XUA"
    data-category="General"
    data-category-id="DIC_kwDOJI1XUM4CU1nn"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
</script>

      </div>
  
</div></div><div class="nexmoe-post-right">    <div class="nexmoe-fixed">
        <div class="nexmoe-tool">

            

            
            

            

            <a href="#nexmoe-content" class="backtop toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
        </div>
    </div>
</div></div><div id="nexmoe-footer"><!--!--></div><div id="nexmoe-search-space"><div class="search-container"><div class="search-header"><div class="search-input-container"><input class="search-input" type="text" placeholder="搜索" onInput="sinput();"></div><a class="search-close" onclick="sclose();">×</a></div><div class="search-body"></div></div></div><div><script src='https://sentry.mixcm.com/js-sdk-loader/affb515ef7b517cb3fc0dc63d65a9fc2.min.js' crossorigin="anonymous"></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2058306854838448" crossorigin="anonymous"></script>
</div></body></html>